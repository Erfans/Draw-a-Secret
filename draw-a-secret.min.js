/**
 * Document   : draw-a-secret aka. picture password
 * Author     : shamabadi.com
 * Description: jQuery extension to make draw-a-secret (aka. picture password) for java script
 */
(function(e,g){var f=function(a,b,c){this.$img=a;this.$input=b;this.pathString="";this.isTouching=!1;this.lastPosition={x:-1,y:-1};this.init(e.extend({rows:15,columns:15,onChange:null,onClear:null},c))};f.prototype.init=function(a){this.options=a;var b=this,c=0,d=b.$img;d.each(function(){this.drawASecret={num:c++,cw:Math.floor(this.width/a.columns),rh:Math.floor(this.height/a.rows)}});d.on("touchstart mousedown",function(a){a.preventDefault();var c=this.drawASecret;b.makeString(a,e(this).offset(),
    c.cw,c.rh,c.num);b.isTouching=!0});d.on("touchmove mousemove",function(c){c.preventDefault();if(b.isTouching){var d=this.drawASecret;b.makeString(c,e(this).offset(),d.cw,d.rh,d.num);if(a.onChange&&"function"==typeof a.onChange)a.onChange()}});d.on("touchend mouseup",function(a){a.preventDefault();b.isTouching=!1});e(g).on("touchend mouseup",function(){b.lastPosition={x:-1,y:-1};b.isTouching=!1});d.on("dragstart",function(a){a.preventDefault()})};f.prototype.makeString=function(a,b,c,d,e){var f=this.lastPosition;
    a=a.originalEvent.touches?a.originalEvent.touches[0]:a;c=Math.floor((a.pageX-b.left)/c);b=Math.floor((a.pageY-b.top)/d);if(f.x!=c||f.y!=b)this.pathString+=""+e+c+b,this.$input&&this.$input.val(this.pathString),this.lastPosition={x:c,y:b}};f.prototype.clearPassword=function(){var a=this.options;this.pathString="";this.$input&&this.$input.val("");if(a.onClear&&"function"==typeof a.onClear)a.onClear()};e.fn.drawSecret=e.fn.drawASecret=function(a,b){var c=a?e(a):null;return new f(this,c,b)}})(jQuery,
    document);