/* 
    Document   : picturePassword
    Created on : Dec 26, 2013
    Author     : Erfan - www.erfan.shamabadi.com
    Description:
        jQuery extension to have picture password on websites
 */
(function(b){b.fn.picturePassword=function(d,n){if(void 0==d)console.error("Password Elememt couldn't be null!");else{d=b(d);var e="",c=!1,l=-1,m=-1,f=-1,g=-1,p=0,h=b.extend({rowsNb:15,columnsNb:15},n);this.clearPassword=function(){e="";d.val(e)};return this.each(function(){this.columnWidth=Math.floor(this.width/h.columnsNb);this.rowHeight=Math.floor(this.height/h.rowsNb);this.imgNum=p++;var k=function(a,b,c,h,k){f=Math.floor((a.pageX-b.left)/c);g=Math.floor((a.pageY-b.top)/h);if(l!=f||m!=g)e+=k.toString()+f.toString()+g.toString(),d.val(e),l=f,m=g};b(this).on("touchstart mousedown",function(a){a.preventDefault();k(a.originalEvent.touches?a.originalEvent.touches[0]:a,b(this).offset(),this.columnWidth,this.rowHeight,this.imgNum);c=!0});b(this).on("touchmove mousemove",function(a){a.preventDefault();a=a.originalEvent.touches?a.originalEvent.touches[0]:a;c&&k(a,b(this).offset(),this.columnWidth,this.rowHeight,this.imgNum)});b(this).on("touchend mouseup",function(a){a.preventDefault();c=!1});b(document).on("touchend mouseup",function(){m=l=-1;c=!1});b(this).on("dragstart",function(a){a.preventDefault()})})}}})(jQuery);