/* 
    Document   : picturePassword
    Author     : erfan.shamabadi.com
    Description:
        jQuery extension to make picture password for website
 */
(function(d,g){"use strict";var e=function(a,b,c){this.$img=a;this.$input=b;this.pathString="";this.isTouching=!1;this.lastPosition={x:-1,y:-1};this.init(d.extend({rows:15,columns:15},c))};e.prototype.init=function(a){var b=this,c=0,f=b.$img;f.each(function(){this.picturePassword={num:c++,cw:Math.floor(this.width/a.columns),rh:Math.floor(this.height/a.rows)}});f.on("touchstart mousedown",function(a){a.preventDefault();var c=this.picturePassword;b.makeString(a,d(this).offset(),c.cw,c.rh,c.num);b.isTouching=!0});f.on("touchmove mousemove",function(a){a.preventDefault();if(b.isTouching){var c=this.picturePassword;b.makeString(a,d(this).offset(),c.cw,c.rh,c.num)}});f.on("touchend mouseup",function(a){a.preventDefault();b.isTouching=!1});d(g).on("touchend mouseup",function(){b.lastPosition={x:-1,y:-1};b.isTouching=!1});f.on("dragstart",function(a){a.preventDefault()})};e.prototype.makeString=function(a,b,c,f,d){var e=this.lastPosition;a=a.originalEvent.touches?a.originalEvent.touches[0]:a;c=Math.floor((a.pageX-b.left)/c);b=Math.floor((a.pageY-b.top)/f);if(e.x!=c||e.y!=b)this.pathString+=""+d+c+b,this.$input&&this.$input.val(this.pathString),this.lastPosition={x:c,y:b}};e.prototype.clearPassword=function(){this.pathString="";this.$input&&this.$input.val("")};d.fn.picturePassword=function(a,b){var c=a?d(a):null;return new e(this,c,b)}})(jQuery,document);